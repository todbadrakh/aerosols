Detailed Quantum Mechanical Geometry Refinement
-----------------------------------------------
The goal of this step is to further refine the geometries of the unique structures which
were optimized at the M08-HX/6-31+G* level of theory in the previous step. This
is necessary because the structures generated by the small-basis geometry optimizations
need to be optimized to a higher degree of accuracy in order to accurately calculate
Gibbs free energies. So, we will
further optimize the geometries of the configurations at the M08-HX/MG3S level of
theory.

At this point, you should be in the small-basis directory
``/home/username/gly-h2o/QM/m08hx-sb``. Copy the 
``uniqueStructures-sb.data`` file to the large-basis calculation directory and change
directory to the large-basis folder.

.. code-block:: bash
   
   $ cp uniqueStructures-sb.data ../m08hx-mg3s/.
   $ cd ../m08hx-mg3s

Now, use the large-basis run script ``run-m08hx-mg3s.csh`` to submit the geometry optimization
jobs. This script automatically reads the ``uniqueStructures-sb.data`` file and
generates a Gaussian 16 input file for each structure and submits the calculations to
the queue in batches.

On Marcy, submit the small-basis geometry optimizations to the mercury queue in batches of
10.

.. code-block:: bash

   $ run-m08hx-mg3s.csh uniqueStructures-sb.data mg3s mercury 10

On Skylight, submit the small-basis geometry optimizations to the stdmem queue in batches
of 10.

.. code-block:: bash

   $ run-m08hx-mg3s.csh uniqueStructures-sb.data mg3s stdmem 10

This will generate Gaussian 16 input files named ``gly-h2o-#-#-m08hx-mg3s.com``, which will
subsequently generate their associated output files named ``gly-h2o-#-#-m08hx-mg3s.log``. A set
of submit scripts are generated as ``run-#.pbs`` on Marcy and ``run-#.slurm`` on Skylight.

Once all jobs are completed, generate a list of rotational constants.

.. code-block:: bash

   $ getRotConsts-dft-lb.csh m08hx 13

This script takes the density functional (``m08hx``) and number of atoms (``13``) as input
and generates a file called ``rotConstsData_C``, which contains the rotational constants of
the clusters sorted according to their energies.

Now, screen for unique structures.

.. code-block:: bash

   $ similarityAnalysis.py mg3s rotConstsData_C

This script generates a file called ``uniqueStructures-mg3s.data`` which contains a list
of the unique structures and their rotational constants.

.. toctree::

